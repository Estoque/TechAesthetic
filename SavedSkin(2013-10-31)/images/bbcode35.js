// BB Decoder for Tistory v3.5 rel
// Copyright (C) 2009-2011 BLUEnLIVE
// http://zoc.kr/
if(!window.BBDecode){var BBDecode=function(){var a={vars:{currentPath:""},utils:{addEvent:function(d,b,c){if(d.attachEvent){d["e"+b+c]=c;d[b+c]=function(){d["e"+b+c](window.event)};d.attachEvent("on"+b,d[b+c])}else{d.addEventListener(b,c,false)}},getCurrentPath:function(){var b=document.getElementsByTagName("script");return b[b.length-1].getAttribute("src").match(/^(.*)\/([^\/]*)$/i)[1]+"/"}},Dec:{BBCode2HTML:function(d){if(d==null||d.length==0){return}var c,b;d=("[##_S_##]"+d+"[##_S_##]").replace(/:\)/g,'<img src="'+a.vars.currentPath+'bbemo1.gif">').replace(/;\)/g,'<img src="'+a.vars.currentPath+'bbemo2.gif">').replace(/:P([^a-z|^A-Z|^0-9])/g,'<img src="'+a.vars.currentPath+'bbemo3.gif">$1').replace(/%8D/g,"%8d").replace(/([^a-z|^A-Z|^0-9])8D([^a-z|^A-Z|^0-9])/g,'$1<img src="'+a.vars.currentPath+'bbemo4.gif">$2').replace(/:\(/g,'<img src="'+a.vars.currentPath+'bbemo5.gif">').replace(/([^a-z|^A-Z])--;/g,'$1<img src="'+a.vars.currentPath+'bbemo6.gif">').replace(/:D([^a-z|^A-Z|^0-9])/g,'<img src="'+a.vars.currentPath+'bbemo7.gif">$1').replace(/:O([^a-z|^A-Z|^0-9])/g,'<img src="'+a.vars.currentPath+'bbemo8.gif">$1').replace(/:x([^a-z|^A-Z|^0-9])/g,'<img src="'+a.vars.currentPath+'bbemo9.gif">$1').replace(/\[url=([\w]+?:\/\/[^ \"\n\r\t<]*?)\]([^?].*?)\[\/url\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ff00ff;">$2</span></a>').replace(/\[url=((www|ftp)\.[^ \"\n\r\t<]*?)\]([^?].*?)\[\/url\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ff00ff;">$2</span></a>').replace(/\[url\]([^?].*?)\[\/url\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ee88bb;">$1</span></a>').replace(/\[ur=([\w]+?:\/\/[^ \"\n\r\t<]*?)\]([^?].*?)\[\/ur\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ff00ff;">$2</span></a>').replace(/\[ur=((www|ftp)\.[^ \"\n\r\t<]*?)\]([^?].*?)\[\/ur\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ff00ff;">$2</span></a>').replace(/\[ur\]([^?].*?)\[\/ur\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ee88bb;">$1</span></a>').replace(/\[link=([\w]+?:\/\/[^ \"\n\r\t<]*?)\]([^?].*?)\[\/link\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ff00ff;">$2</span></a>').replace(/\[link=((www|ftp)\.[^ \"\n\r\t<]*?)\]([^?].*?)\[\/link\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ff00ff;">$2</span></a>').replace(/\[link\]([^?].*?)\[\/link\]/gi,'<a href="$1" target="_blank"><span style="border-bottom: 1px solid #ee88bb;">$1</span></a>').replace(/\[img\]([^\s\'\"\n\r\t<]*)\[\/img\]/gi,'<img src="$1" hspace="2" alt=""/>').replace(/\[img=([^\s\'\"\n\r\t<]*)\]/gi,'<img src="$1" hspace="2" alt=""/>').replace(/\[email\]([a-z0-9_\.-]+@[a-z0-9_\.-]+)\[\/email\]/gi,'<a href="mailto:$1">$1</a>').replace(/\[email=([a-z0-9_\.-]+)@([a-z0-9_\.-]+)\](.*?)\[\/email\]/gi,'<a href="mailto:$1@$2">$3</a>').replace(/\[spoiler](.+?)\[\/spoiler]/gi,"<div style=\"padding:3px;background-color:#F8F8F8;border:1px solid #d8d8d8;font-size:1em;\"><div style=\"text-transform:uppercase;border-bottom:1px solid #CCCCCC;margin-bottom:3px;font-size:0.8em;font-weight:bold;display:block;\"><span onClick=\"if (this.parentNode.parentNode.getElementsByTagName('div')[1].getElementsByTagName('div')[0].style.display != '') {  this.parentNode.parentNode.getElementsByTagName('div')[1].getElementsByTagName('div')[0].style.display = ''; this.innerHTML = '<b>Spoiler: </b><a href=\\'#\\' onClick=\\'return false;\\'>hide</a>'; } else { this.parentNode.parentNode.getElementsByTagName('div')[1].getElementsByTagName('div')[0].style.display = 'none'; this.innerHTML = '<b>Spoiler: </b><a href=\\'#\\' onClick=\\'return false;\\'>show</a>'; }\" /><b>Spoiler: </b><a href=\"#\" onClick=\"return false;\">show</a></span></div><div class=\"quotecontent\"><div style=\"display: none;\">$1</div></div></div>").replace(/\n/g,"[##_E_##]");b=0;do{c=d.replace(/\[ru]\[\/ru]/gi,"").replace(/\[ru](.+?)\[\/ru]/gi,'<span style="border-bottom:1px solid red;">$1</span>').replace(/\[bu]\[\/bu]/gi,"").replace(/\[bu](.+?)\[\/bu]/gi,'<span style="border-bottom:1px solid blue;">$1</span>').replace(/\[rb]\[\/rb]/gi,"").replace(/\[rb](.+?)\[\/rb]/gi,'<span style="color: red"><strong>$1</strong></span>').replace(/\[bb]\[\/bb]/gi,"").replace(/\[bb](.+?)\[\/bb]/gi,'<span style="color: blue"><strong>$1</strong></span>').replace(/\[red]\[\/red]/gi,"").replace(/\[red](.+?)\[\/red]/gi,'<span style="color: red">$1</span>').replace(/\[blue]\[\/blue]/gi,"").replace(/\[blue](.+?)\[\/blue]/gi,'<span style="color: blue">$1</span>').replace(/\[i]\[\/i]/gi,"").replace(/\[i](.+?)\[\/i]/gi,"<em>$1</em>").replace(/\[b]\[\/b]/gi,"").replace(/\[b](.+?)\[\/b]/gi,"<strong>$1</strong>").replace(/\[u]\[\/u]/gi,"").replace(/\[u](.+?)\[\/u]/gi,"<ins>$1</ins>").replace(/\[s]\[\/s]/gi,"").replace(/\[s](.+?)\[\/s]/gi,"<del>$1</del>").replace(/\[color=(.+?)]\[\/color]/gi,"").replace(/\[color=(.+?)](.+?)\[\/color]/gi,'<span style="color: $1">$2</span>').replace(/\[quote]\[\/quote]/gi,"[quote] [/quote]").replace(/\[quote](.+?)\[\/quote]/gi,'<table width="95%" bgcolor="#d8d8d8" cellspacing="0" cellpadding="1" align="center"><tr><td><table width="100%" bgcolor="#f8f8f8" cellspacing="0" cellpadding="5"><tr><td><span>$1</span></td></tr></table></td></tr></table>').replace(/\[c=(.+?)]\[\/c]/gi,"").replace(/\[c=(.+?)](.+?)\[\/c]/gi,'<span style="color: $1">$2</span>').replace(/\[q]\[\/q]/gi,"[q] [/q]").replace(/\[q](.+?)\[\/q]/gi,'<table width="95%" bgcolor="#d8d8d8" cellspacing="0" cellpadding="1" align="center"><tr><td><table width="100%" bgcolor="#f8f8f8" cellspacing="0" cellpadding="5"><tr><td><span>$1</span></td></tr></table></td></tr></table>');if(d==c){b=1}else{d=c}}while(b==0);d=d.replace(/\[embed](.+?)\[\/embed]/gi,"[embed=$1]").replace(/\[embed=]/gi,"").replace(/\[embed=http:\/\/youtu\.be\/(.+?)]/gi,"[embed=http://youtube.com/watch?v=$1]").replace(/(\[embed=.+?)]/gi,"$1 425 355 none ]").replace(/(\[embed=.+?)&amp.+?\s(.+?)]/gi,"$1 $2 ]").replace(/(\[embed=.+?)\/watch\?v=(.+?)]/gi,"$1/v/$2]").replace(/\[embed=(.+?)\s(.+?)\s(.+?)\s.+?]/gi,'<center><embed allowScriptAccess="never" src=$1 width=$2 height=$3></center>');b=0;do{c=d.replace(/\[\*\]([^\[]+)/i,"<li>$1</li>");if(d==c){b=1}else{d=c}}while(b==0);d=d.replace(/\[list\](.+?)\[\/list\]/gi,"<ol>$1</ol>");d=d.replace(/\[size=([\d\.]+)\](.+?)\[\/size\]/gi,'<span style="font-size:$1px">$2</span>');b=0;do{c=d.replace(/\[code\](.*)\s(.*)\[\/code\]/gi,"[code]$1&nbsp;$2[/code]");if(d==c){b=1}else{d=c}}while(b==0);d=d.replace(/\[code\]<br\s*\/?>/gi,"[code]").replace(/<br\s*\/?>\[\/code\]/gi,"[/code]").replace(/\[code\](.+?)\[\/code\]/gi,'<div style="font: 400 1em/1.2 Consolas, Courier New, Courier, mono, serif; background-color: #F0F0F0; font-color:#000; padding:5px;">$1</div>').replace(/\[##_E_##\]/g,"\n").replace(/\[##_S_##\]/g,"").replace(/\\#/g,"#").replace(/\[\s##_(.*)_##\s\]/g,"[##_$1_##]");return d},Decode:function(b){var c=0;if(b==null||b.length==0){return}b.innerHTML=a.Dec.BBCode2HTML(b.innerHTML)}},DecodeAll:function(c){var f=[];var g={};var b=document.getElementsByTagName("div");for(var e=0;e<b.length;e++){if(b[e].getAttributeNode("class")&&b[e].style&&b[e].getAttributeNode("class").value=="bbcode"){f.push(b[e])}}if(f.length==0){return}for(var e=0;e<f.length;e++){var d=f[e];a.Dec.Decode(d);d.getAttributeNode("class").value="nobbcode"}},ResetTimer:function(){},UpdateBBCode:function(){a.DecodeAll("bbcode");setTimeout("BBDecode.UpdateBBCode()",3000)},init:function(){a.vars.currentPath=a.utils.getCurrentPath();a.utils.addEvent(window,"load",function(){BBDecode.UpdateBBCode()})}};return a}()}BBDecode.init();
